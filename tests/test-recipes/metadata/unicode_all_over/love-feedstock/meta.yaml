package:
  name: ♥
  version: 1

build:
  # Nearly there (for Python 3 at least), but not ready yet.
  skip: True  # [win]
  script:

    - chcp 65001  # [win]
    - "mkdir %%PREFIX%%\\bin"  # [win]
    - "echo echo ♥>%%PREFIX%%\\bin\\♥.bat"  # [win]

    - "echo \"\u0023\u0021/usr/bin/env bash\" >$PREFIX/bin/♥"  # [not win]
    - echo "echo '♥'" >>$PREFIX/bin/♥  # [not win]
    - chmod +x $PREFIX/bin/♥  # [not win]

test:
  commands:
    # The .*'s are for newlines.
    - "[[ $($PREFIX/bin/♥) =~ .*♥.* ]] || (echo \"Where is the ♥?\" && exit 1)"  # [not win]
    - "call %%PREFIX%%\\bin\\♥.bat | findstr ♥"  # [win]
    - eval $($CONDA_EXE shell.bash hook)   # [not win]
    - "[[ $($CONDA_EXE run ♥) =~ .*♥.* ]] || (echo \"Where is the conda run ♥?\" && exit 1)"  # [not win]
